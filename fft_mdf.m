function [X,x,df]=fft_mdf(x,ts,df) % Syntax: [X,x,df]=fft_mdf(x,ts,df) or [X,x,df]=fft_mdf(x,ts) % Modified fft ~ sample interval 및 목표 spectrum resolution 이 주어지면% 이로부터 FFT points 개수를 계산하고 정확한 spectrum resolution 재계산 % This function generates X, the FFT of the signal x.%		-------------------------------------------------------------------%		Input ts is the sampling interval. %       Input df is the frequency resolution. %       The signal x is zero padded to meet the required frequency resolution df.%       Output df is the modified frequency resolution.%		Output x is the zero padded version of input x.fs = 1/ts;            % Frequency rangeif nargin == 2       % If df is not given (즉, 목표 주파수 해상도가 없으면)  n1 = 0;else  n1 = fs/df;        % Number of data in the frequency domainend% If length(x) is not power of 2, the sequence x is zero padded n2 = length(x);N = 2^(max(nextpow2(n1),nextpow2(n2)));  % Number of data is modified to be power of 2X = fft(x, N);x = [x,zeros(1, N - n2)];  % Time domain signal is zero padded at the enddf = fs/N;  % Frequency resolution is modified if signal x is zero padded